<!DOCTYPE html>
<html lang="ja">
<head>
    <!--æ›´æ–° -->
    ã‚¹ã‚¿ãƒ¼ãƒˆï¼’
    <!--ãƒ”ãƒ³ãƒã‚¢ã‚¦ãƒˆè¿½åŠ  -->

   
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ¤ç‰©ã®åˆ†é¡ã‚ã‘ã‚¯ã‚¤ã‚ºã‚²ãƒ¼ãƒ </title>

  <!-- â–¼ ãƒ¬ãƒˆãƒ­ã‚²ãƒ¼ãƒ é¢¨ãƒ•ã‚©ãƒ³ãƒˆã‚’ä½¿ã„ãŸã„å ´åˆã¯Google Fontsãªã©ã§èª­ã¿è¾¼ã‚€ä¾‹ï¼ˆPress Start 2Pãªã©ï¼‰ 
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  -->
  
  <style>
    /* å…¨ä½“è¨­å®š touch-action: manipulation; è¿½åŠ */
    body {      
      touch-action: manipulation;
      background-color: black;
      color: white;
      /* ãƒ‰ãƒƒãƒˆé¢¨ãƒ•ã‚©ãƒ³ãƒˆã‚’ä½¿ã†å ´åˆã¯ä¸‹è¨˜ã®ã‚ˆã†ã«æŒ‡å®š
         (Press Start 2PãŒèª­ã¿è¾¼ã‚ãªã„å ´åˆã¯monospaceãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯) */
      font-family: 'Press Start 2P', monospace;
      margin: 0;
      padding: 0;
      text-align: center;
    }
    /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ */
      /*æ¶ˆã™ã‚‚ã¨ã‚‚ã¨ã®ã‚½ãƒ¼ã‚¹#gameContainer {max-width: 320px;
      margin: 0 auto;
      padding: 10px;
    }*/
      
#gameContainer {
    width: 90vw; /* ç”»é¢å¹…ã®90% */
    max-width: 100vw; /* æœ€å¤§å¹…ã‚’ç”»é¢å¹…ã¾ã§ */
    height: auto; /* é«˜ã•ã¯å†…å®¹ã«åˆã‚ã›ã‚‹ */
    background-color: black;
    color: white;
    text-align: center;
    transform-origin: center;
    margin: auto; /* ä¸­å¤®é…ç½® */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    overflow: hidden; /* ã¯ã¿å‡ºã—é˜²æ­¢ */
}



      

        
  

    /* ãƒ‰ãƒ©ã‚¯ã‚¨é¢¨ã®æ ç·šã‚’ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼šå¤ªã‚ã®ç™½æ ã€é»’èƒŒæ™¯ */
    .dq-frame {
      border: 3px double white;    /* å¤ªã‚ã®ç™½æ ã‚’2é‡ç·šé¢¨ã« */
      background-color: black;
      color: white;
      padding: 8px;
      margin: 10px auto;
      box-sizing: border-box;
    }

    /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ï¼šãƒ‰ãƒ©ã‚¯ã‚¨é¢¨ã«3è¡Œç¨‹åº¦ */
    #messageBox {
      width: 90%;
      height: 60px; /* 3è¡Œå›ºå®š */
      overflow: hidden;
      margin: 10px auto;
      font-size: 14px;
    }

    /* HPãƒãƒ¼ */
   .hp-bar {
  width: 100%;
  height: 20px;
  border: 1px solid white;
  position: relative;
  margin: 5px 0;
  display: flex;
  align-items: center;
}

.hp-inner {
  height: 100%;
  background: linear-gradient(to right, red, darkred);
  transition: width 0.3s ease-in-out;
}

    .hp-text {
    position: relative;
    width: 100%;
    text-align: center;
    line-height: 20px;
    font-size: 12px;
    color: white;
}


    /* æ¤ç‰©ç”»åƒè¡¨ç¤ºé ˜åŸŸ */
    #plantImageContainer {
      width: 300px;
      height: 300px;
      margin: 10px auto;
      border: 3px double white;
      background-color: black;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    #plantImage {
      max-width: 80%;
      max-height: 80%;
    }

    /* ãƒœã‚¿ãƒ³å…¨èˆ¬ï¼šãƒ‰ãƒ©ã‚¯ã‚¨é¢¨ï¼ˆé»’èƒŒæ™¯ãƒ»ç™½æ–‡å­—ãƒ»ç™½æ ï¼‰ */
    .button {
      background-color: black;
      border: 2px solid white;
      color: white;
      padding: 8px 12px;
      margin: 5px;
      cursor: pointer;
      font-family: 'Press Start 2P', monospace;
      font-size: 14px;
    }
    .button:hover {
      background-color: white;
      color: black;
    }
    #startButton, #mouthButton {
      margin: 20px;
    }

    /* é¸æŠè‚¢ã‚¨ãƒªã‚¢ï¼šã‚³ãƒãƒ³ãƒ‰ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã£ã½ã */
    #classificationButtons {
      width: 240px;
      /* ãƒ‰ãƒ©ã‚¯ã‚¨é¢¨ã®æ  */
      border: 3px double white;
      background-color: black;
      margin: 10px auto;
      padding: 10px;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 5px;
      justify-items: center;
    }

    /* ãƒˆã‚°ãƒ«ã‚¹ã‚¤ãƒƒãƒï¼ˆBGM ON/OFFï¼‰ */
    .switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 34px;
      margin: 10px;
    }
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: #999;
      border: 2px solid white;
      transition: .4s;
      border-radius: 34px;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 26px;
      width: 26px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }
    input:checked + .slider {
      background-color: #33cc33;
    }
    input:checked + .slider:before {
      transform: translateX(26px);
    }
    .slider:after {
      content: "OFF";
      color: white;
      display: block;
      position: absolute;
      transform: translate(-50%,-50%);
      top: 50%; left: 70%;
      font-size: 10px;
      font-family: 'Press Start 2P', monospace;
    }
    input:checked + .slider:after {
      content: "ON";
      left: 30%;
    }
  </style>
</head>
<body>

<!-- æ¶ˆã™ãƒ”ãƒ³ãƒã‚¢ã‚¦ãƒˆè¿½åŠ  
    
    <div id="zoomTarget">ãƒ”ãƒ³ãƒã—ã¦ã‚ºãƒ¼ãƒ </div>
    
    
-->


   
  <div id="gameContainer">
    <!-- ã‚¹ã‚¿ãƒ¼ãƒˆç”»é¢ï¼ˆDQé¢¨ã«æ ã§å›²ã‚“ã§ã‚‚OKï¼‰ -->
    <div id="startScreen" class="dq-frame">
      <button id="startButton" class="button">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
    </div>
    
    <!-- ã‚²ãƒ¼ãƒ ç”»é¢ -->
    <div id="gameScreen" style="display: none;">
      <!-- æ¤ç‰©HPãƒãƒ¼ -->
<div id="plantHP" class="hp-bar">
  <div id="plantHPInner" class="hp-inner" style="width: 100%;"></div>
  <div class="hp-text" id="plantHPText">æ¤ç‰©HP: 100</div>
</div>

<!-- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼HPãƒãƒ¼ -->
<div id="playerHP" class="hp-bar">
  <div id="playerHPInner" class="hp-inner" style="width: 100%;"></div>
  <div class="hp-text" id="playerHPText">ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼HP: 100</div>
</div>

      
      <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ï¼ˆDQé¢¨æ ï¼‰ -->
      <div id="messageBox" class="dq-frame"></div>
      
      <!-- æ¤ç‰©ç”»åƒï¼ˆDQé¢¨æ ï¼‰ -->
      <div id="plantImageContainer">
        <img id="plantImage" src="" alt="æ¤ç‰©ç”»åƒ">
      </div>
      
      <!-- BGM ON/OFFã‚¹ã‚¤ãƒƒãƒ -->
      <label class="switch">
        <input type="checkbox" id="bgmCheckbox" checked>
        <span class="slider"></span>
      </label>
      
      <!-- åˆ†é¡é¸æŠãƒœã‚¿ãƒ³ï¼ˆDQé¢¨ã‚³ãƒãƒ³ãƒ‰ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ï¼‰ -->
      <div id="classificationButtons">
        <button class="button classification" data-class="ã‚¢ãƒ–ãƒ©ãƒŠç§‘">ã‚¢ãƒ–ãƒ©ãƒŠç§‘</button>
        <button class="button classification" data-class="ã‚¤ãƒç§‘">ã‚¤ãƒç§‘</button>
        <button class="button classification" data-class="ã‚¦ãƒªç§‘">ã‚¦ãƒªç§‘</button>
        <button class="button classification" data-class="ã‚­ã‚¯ç§‘">ã‚­ã‚¯ç§‘</button>
        <button class="button classification" data-class="ãƒãƒ¡ç§‘">ãƒãƒ¡ç§‘</button>
        <button class="button classification" data-class="ãã®ä»–">ãã®ä»–</button>
      </div>
      
      <!-- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼HPãƒãƒ¼ -->
      <div id="playerHP" class="hp-bar">
        <div class="hp-text" id="playerHPText">ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼HP: 100</div>
      </div>
      
      <!-- ã‚²ãƒ¼ãƒ çµ‚äº†æ™‚ï¼šãã¡ã¶ãˆãƒœã‚¿ãƒ³ -->
      <div id="endScreen" class="dq-frame" style="display: none;">
        <button id="mouthButton" class="button">â–¶ãã¡ã¶ãˆ</button>
      </div>
    </div>
  </div>
  
  <!-- BGM -->
<audio id="bgm" src="https://kogkoba.github.io/bunrui/sciencebgm.mp3" loop></audio>

<script>
    const bgm = document.getElementById('bgm');
    const bgmCheckbox = document.getElementById('bgmCheckbox');
    const startButton = document.getElementById('startButton');

    // **åˆæœŸè¨­å®š**ï¼ˆBGMã¯ãƒŸãƒ¥ãƒ¼ãƒˆã€ã‚¹ã‚¤ãƒƒãƒOFFï¼‰
    bgm.volume = 0;
    bgmCheckbox.checked = false;

    // **ã‚²ãƒ¼ãƒ é–‹å§‹æ™‚ã«BGMã‚’å†ç”Ÿï¼ˆãƒŸãƒ¥ãƒ¼ãƒˆçŠ¶æ…‹ã§ï¼‰**
    function startGame() {
        document.getElementById('startScreen').style.display = 'none';
        document.getElementById('gameScreen').style.display = 'block';

        // **ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œå¾Œãªã®ã§BGMå†ç”Ÿå¯èƒ½**
        bgm.play().catch(error => console.error("BGMå†ç”Ÿã‚¨ãƒ©ãƒ¼:", error));
    }

    // **ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã‚‰ã‚²ãƒ¼ãƒ é–‹å§‹**
    let startButton = document.getElementById('startButton');
let bgm = document.getElementById('bgm');
let bgmCheckbox = document.getElementById('bgmCheckbox');

// **ã‚²ãƒ¼ãƒ é–‹å§‹æ™‚ã®BGMè¨­å®šï¼ˆãƒŸãƒ¥ãƒ¼ãƒˆã§å†ç”Ÿï¼‰**
bgm.volume = 0;  // ğŸ”¹ æœ€åˆã¯ãƒŸãƒ¥ãƒ¼ãƒˆ
bgmCheckbox.checked = false; // ğŸ”¹ ã‚¹ã‚¤ãƒƒãƒã‚‚OFFã«ã™ã‚‹

// **ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã®å‹•ä½œ**
startButton.addEventListener('click', startGame);

function startGame() {
    document.getElementById('startScreen').style.display = 'none';
    document.getElementById('gameScreen').style.display = 'block';
    
    // **ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œå¾Œãªã®ã§BGMå†ç”Ÿå¯èƒ½ï¼ˆãŸã ã—ãƒŸãƒ¥ãƒ¼ãƒˆã®ã¾ã¾ï¼‰**
    bgm.play().catch(error => console.error("BGMå†ç”Ÿã‚¨ãƒ©ãƒ¼:", error));

    // **æœ€åˆã®å•é¡Œã‚’å‡ºé¡Œ**
    nextQuestion();
}

// **BGM ON/OFFã‚¹ã‚¤ãƒƒãƒã®å‹•ä½œ**
bgmCheckbox.addEventListener('change', () => {
    if (bgmCheckbox.checked) {
        bgm.volume = 1.0;  // ğŸµ BGMã‚’ONï¼ˆéŸ³é‡100%ï¼‰
    } else {
        bgm.volume = 0;    // ğŸ”‡ BGMã‚’ãƒŸãƒ¥ãƒ¼ãƒˆï¼ˆéŸ³é‡0ï¼‰
    }
});


    // **BGM ON/OFFã‚¹ã‚¤ãƒƒãƒã®åˆ¶å¾¡**
    bgmCheckbox.addEventListener('change', () => {
        if (bgmCheckbox.checked) {
            bgm.volume = 1.0; // BGMã‚’ONï¼ˆéŸ³é‡100%ï¼‰
        } else {
            bgm.volume = 0; // BGMã‚’ãƒŸãƒ¥ãƒ¼ãƒˆï¼ˆéŸ³é‡0ï¼‰
        }
    });
</script>


  
  <script>

     <!-- ãƒ”ãƒ³ãƒã‚¢ã‚¦ãƒˆè¿½åŠ  -->

let zoomTarget = document.getElementById("gameContainer"); // ã‚ºãƒ¼ãƒ å¯¾è±¡ã‚’å¤‰æ›´
let initialDistance = 0;
let scale = 1;
const minScale = 0.5;  // æœ€å°50%ã¾ã§ç¸®å°å¯èƒ½
const maxScale = 2.5;  // æœ€å¤§250%ã¾ã§æ‹¡å¤§å¯èƒ½

function getDistance(touches) {
    let dx = touches[0].clientX - touches[1].clientX;
    let dy = touches[0].clientY - touches[1].clientY;
    return Math.sqrt(dx * dx + dy * dy);
}

document.addEventListener("touchstart", (event) => {
    if (event.touches.length === 2) {
        initialDistance = getDistance(event.touches);
    }
});

document.addEventListener("touchmove", (event) => {
    if (event.touches.length === 2) {
        let newDistance = getDistance(event.touches);
        let zoomFactor = newDistance / initialDistance;
        scale *= zoomFactor;

        // **ç¸®å°ãƒ»æ‹¡å¤§ã®ç¯„å›²ã‚’åˆ¶é™**
        if (scale < minScale) scale = minScale;
        if (scale > maxScale) scale = maxScale;

        zoomTarget.style.transform = `scale(${scale})`;
        initialDistance = newDistance;
        event.preventDefault(); // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é˜²æ­¢
    }
});





     
    /*
      â–¼ ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã¨ index.html ã¯åŒã˜éšå±¤ã‚’æƒ³å®šã€‚
      â–¼ GitHub Pagesã®è¨­å®šã¯ mainãƒ–ãƒ©ãƒ³ãƒ/(root)ã€‚
      â–¼ 69ç¨®ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã“ã“ã«è¿½åŠ ã—ã¦ãã ã•ã„ã€‚
    */
    const plants = [
      { file: "aburanna.png", classification: "ã‚¢ãƒ–ãƒ©ãƒŠç§‘", name: "ã‚¢ãƒ–ãƒ©ãƒŠ" },
      { file: "kiku.png", classification: "ã‚­ã‚¯ç§‘", name: "ã‚­ã‚¯" }
      // ... ã“ã“ã«69ç¨®åˆ†ã‚’è¿½åŠ  ...
    ];

    let currentPlant = null;
    let plantHP = 100;
    let playerHP = 100;
    
    const startButton = document.getElementById('startButton');
    const gameScreen = document.getElementById('gameScreen');
    const messageBox = document.getElementById('messageBox');
    const plantImage = document.getElementById('plantImage');
    const plantHPText = document.getElementById('plantHPText');
    const playerHPText = document.getElementById('playerHPText');
    const classificationButtons = document.querySelectorAll('.classification');
    const mouthButton = document.getElementById('mouthButton');
    const endScreen = document.getElementById('endScreen');
    const bgm = document.getElementById('bgm');
    const bgmCheckbox = document.getElementById('bgmCheckbox');
    
    startButton.addEventListener('click', startGame);
    
    classificationButtons.forEach(button => {
      button.addEventListener('click', () => {
        const originalText = button.innerText;
        button.innerText = "â–¶" + originalText;
        setTimeout(() => { button.innerText = originalText; }, 200);
        handleAnswer(button.getAttribute('data-class'));
      });
    });
    
    mouthButton.addEventListener('click', () => { location.reload(); });
    
    // BGM ON/OFF
    bgmCheckbox.addEventListener('change', () => {
      if (bgmCheckbox.checked) {
        bgm.play().catch(error => console.error("BGMå†ç”Ÿã‚¨ãƒ©ãƒ¼:", error));
      } else {
        bgm.pause();
      }
    });
    
    function startGame() {
      document.getElementById('startScreen').style.display = 'none';
      gameScreen.style.display = 'block';
      if (bgmCheckbox.checked) {
        bgm.play().catch(error => console.error("BGMå†ç”Ÿã‚¨ãƒ©ãƒ¼:", error));
      }
      nextQuestion();
    }
    
    function nextQuestion() {
    messageBox.innerText = "";
    currentPlant = plants[Math.floor(Math.random() * plants.length)];

    // ç”»åƒã®ãƒ‘ã‚¹ã‚’ä¿®æ­£ï¼ˆindex.htmlã¨åŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚ã‚‹ã¨ä»®å®šï¼‰
    plantImage.src = "./science2/" + currentPlant.file;


    messageBox.innerText = "æ¤ç‰©ãŒã€€ã‚ã‚‰ã‚ã‚ŒãŸã€‚";
    setTimeout(() => {
        messageBox.innerText = "æ¤ç‰©ã¯ " + currentPlant.name + " ã‚’ã€€ãã‚Šã ã—ãŸã€‚";
    }, 400);
}

    
    function handleAnswer(selectedClass) {
    if (selectedClass === currentPlant.classification) {
        messageBox.innerText = currentPlant.name + " ã¯ã€€" + currentPlant.classification + " ã ";
        setTimeout(() => {
            messageBox.innerText = "æ­£è§£ï¼ æ¤ç‰©ã«20ã®ãƒ€ãƒ¡ãƒ¼ã‚¸";
            plantHP -= 20;
            updateHP(); // ã“ã“ã§HPãƒãƒ¼ã‚’æ›´æ–°
            checkGameOver();
            if (plantHP > 0) {
                setTimeout(nextQuestion, 1000);
            }
        }, 1000);
    } else {
        messageBox.innerText = "ãƒŸã‚¹ï¼";
        setTimeout(() => {
            messageBox.innerText = currentPlant.name + " ã¯ã€€" + currentPlant.classification + " ã ";
            setTimeout(() => {
                messageBox.innerText = "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«20ã®ãƒ€ãƒ¡ãƒ¼ã‚¸";
                playerHP -= 20;
                updateHP(); // ã“ã“ã§HPãƒãƒ¼ã‚’æ›´æ–°
                checkGameOver();
                if (playerHP > 0) {
                    setTimeout(nextQuestion, 1000);
                }
            }, 1000);
        }, 500);
    }
}



function updateHP() {
    // HPãƒ†ã‚­ã‚¹ãƒˆã®æ›´æ–°
    plantHPText.innerText = "æ¤ç‰©HP: " + Math.max(0, plantHP);
    playerHPText.innerText = "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼HP: " + Math.max(0, playerHP);

    // HPãƒãƒ¼ã®è¦‹ãŸç›®ã‚’æ›´æ–°ï¼ˆæœ€å¤§100%ã®ã‚¹ã‚±ãƒ¼ãƒ«ã§æ¸›å°‘ï¼‰
    document.getElementById('plantHPInner').style.width = Math.max(0, plantHP) + "%";
    document.getElementById('playerHPInner').style.width = Math.max(0, playerHP) + "%";
}




    function checkGameOver() {
      if (plantHP <= 0 || playerHP <= 0) {
        if (plantHP <= 0) {
          messageBox.innerText = "æ¤ç‰©ã¯ã€€ãŸãŠã‚ŒãŸã€‚";
        } else {
          messageBox.innerText = "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ã€€ãŸãŠã‚ŒãŸã€‚";
        }
        plantImage.style.display = "none";
        classificationButtons.forEach(btn => btn.style.display = "none");
        document.getElementById('plantHP').style.display = "none";
        document.getElementById('playerHP').style.display = "none";
        endScreen.style.display = "block";
      }
    }
  </script>
</body>
</html>
